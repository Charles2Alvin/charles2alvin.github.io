{"ast":null,"code":"import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Details_funcs from '../details/detailsReact';\nimport PrivateGallery_funcs from '../privateGallery/privateGalleryReact';\nimport ENDPOINT from '../apiConfig';\nlet currentItem;\nlet privateGallery = [];\nlet userEmail = \"\";\n\nfunction setCurrentItem(item) {\n  currentItem = item;\n}\n\nfunction setUserEmail(email) {\n  userEmail = email;\n}\n\nfunction getUserEmail() {\n  return userEmail;\n}\n\nfunction getCurrentItem() {\n  return currentItem;\n}\n\nfunction updateDetailPage() {\n  let artwork = getCurrentItem();\n  console.log(artwork);\n  let view = new Details_funcs.DetailsView1(artwork);\n  ReactDOM.render(view, document.body.querySelector(\"#details\")); // view.render();\n}\n\nfunction initialPrivateGallery() {\n  setPrivateGallery(getFavouriteList());\n}\n\nfunction setPrivateGallery(gallery) {\n  if (gallery) privateGallery = gallery;\n}\n\nfunction getPrivateGallery() {\n  return privateGallery;\n}\n\nfunction updatePrivateGallery() {\n  //array of artwork\n  console.log(getPrivateGallery());\n\n  if (!getPrivateGallery()) {\n    // console.log(\"getPrivateGallery(): \"+getPrivateGallery());\n    setPrivateGallery().push(getCurrentItem()); //\n\n    addFavorite();\n    getFavouriteList(); //    console.log();\n  } else {\n    let isExist = false;\n    console.log(getPrivateGallery());\n\n    for (let x of getPrivateGallery()) {\n      //    console.log(\"x: \"+x.id +\"    item: \"+getCurrentItem().id);\n      if (x.id == getCurrentItem().id) {\n        //    console.log(\"x!=now + \"+x.id != getCurrentItem().id);\n        isExist = true;\n      }\n    }\n\n    if (!isExist) {\n      // console.log(\"hey\");\n      getPrivateGallery().push(getCurrentItem()); //更新数据库 个人收藏页\n\n      addFavorite();\n      getFavouriteList();\n    }\n  } // console.log(getFavouriteList());\n\n\n  let artworkList = getPrivateGallery(); //    console.log(\"artworkList: \"+artworkList);\n\n  let view = new PrivateGallery_funcs.PrivateGalleryView1(artworkList = {\n    artworkList\n  });\n  ReactDOM.render(view, document.body.querySelector(\"#privateGallery\")); // view.render(document.body.querySelector(\"#privateGallery\"));\n}\n\nfunction addFavorite() {\n  var myHeaders = new Headers();\n  myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n  var urlencoded = new URLSearchParams();\n  urlencoded.append(\"email\", getUserEmail());\n  urlencoded.append(\"objectID\", getCurrentItem().id); // console.log(getCurrentItem().id);\n\n  var requestOptions = {\n    method: 'POST',\n    headers: myHeaders,\n    body: urlencoded,\n    redirect: 'follow'\n  };\n  fetch(\"https://afternoon-gorge-52652.herokuapp.com/addFavorite\", requestOptions).then(response => response.text()).then(result => console.log(result)).catch(error => console.log('error', error));\n}\n\nfunction getFavouriteList() {\n  var urlencoded = new URLSearchParams();\n  var requestOptions = {\n    method: 'GET',\n    redirect: 'follow'\n  };\n  console.log(getUserEmail());\n  fetch(\"https://afternoon-gorge-52652.herokuapp.com/getFavorite?email=\" + getUserEmail(), requestOptions).then(response => response.text()).then(result => console.log(result)).catch(error => console.log('error', error));\n} // function keyUp(event){\n//     if(event.keyCode===38){\n//     }\n// }\n\n\nfunction getArtwork() {\n  function handleHTTPError(response) {\n    if (response.ok) return response;\n    throw Error(response.statusText);\n  }\n\n  return fetch(ENDPOINT + \"artworks?limit=30\", {\n    \"method\": \"GET\"\n  }).then(handleHTTPError).then(response => response.json()) // from headers to response data\n  .then(data => data.data) // leave out the unimportant parts of the response data\n  .catch(console.error);\n}\n\nfunction getArtworkPicture() {\n  //通过id找到本地artworklist中的artwork -> thumbnail, width, height\n  // => image_url = thumbnail.url +/full/+ width, + /0/default.jpg\n  // https://www.artic.edu/iiif/2/7e21e656-ddae-de1c-f46b-a869224043bd/full/2101,/0/default.jpg\n  return \"https://www.artic.edu/iiif/2/7e21e656-ddae-de1c-f46b-a869224043bd\" + \"/full/\" + \"2101,\" + \"/0/default.jpg\";\n}\n\nconst Utils_funcs = {\n  setCurrentItem,\n  getCurrentItem,\n  updateDetailPage,\n  setPrivateGallery,\n  getPrivateGallery,\n  updatePrivateGallery,\n  getArtwork,\n  getArtworkPicture,\n  getFavouriteList,\n  initialPrivateGallery,\n  getUserEmail,\n  setUserEmail\n};\nexport default Utils_funcs;","map":{"version":3,"sources":["/Users/mohaitao/Desktop/MyGitPage/charles2alvin.github.io/src/util/utils.js"],"names":["React","ReactDOM","Details_funcs","PrivateGallery_funcs","ENDPOINT","currentItem","privateGallery","userEmail","setCurrentItem","item","setUserEmail","email","getUserEmail","getCurrentItem","updateDetailPage","artwork","console","log","view","DetailsView1","render","document","body","querySelector","initialPrivateGallery","setPrivateGallery","getFavouriteList","gallery","getPrivateGallery","updatePrivateGallery","push","addFavorite","isExist","x","id","artworkList","PrivateGalleryView1","myHeaders","Headers","append","urlencoded","URLSearchParams","requestOptions","method","headers","redirect","fetch","then","response","text","result","catch","error","getArtwork","handleHTTPError","ok","Error","statusText","json","data","getArtworkPicture","Utils_funcs"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Details_funcs from '../details/detailsReact';\nimport PrivateGallery_funcs from '../privateGallery/privateGalleryReact';\nimport ENDPOINT from '../apiConfig';\n\nlet currentItem;\nlet privateGallery=[];\nlet userEmail = \"\";\nfunction setCurrentItem(item){\n    currentItem = item;\n    \n    \n}\nfunction setUserEmail(email){\n    userEmail = email;\n}\nfunction getUserEmail(){\n    return userEmail;\n}\nfunction getCurrentItem(){\n    return currentItem;\n}\nfunction updateDetailPage(){\n    let artwork = getCurrentItem();\n    console.log(artwork);\n    let view = new Details_funcs.DetailsView1(artwork);\n    ReactDOM.render(view, document.body.querySelector(\"#details\"));\n    // view.render();\n}\nfunction initialPrivateGallery(){\n    setPrivateGallery(getFavouriteList());\n}\nfunction setPrivateGallery(gallery){\n    if(gallery)\n        privateGallery = gallery;\n}\nfunction getPrivateGallery(){\n    return privateGallery;\n}\nfunction updatePrivateGallery(){\n    //array of artwork\n    console.log(getPrivateGallery());\n    if(!getPrivateGallery()){   \n        // console.log(\"getPrivateGallery(): \"+getPrivateGallery());\n       setPrivateGallery().push(getCurrentItem());\n       //\n       addFavorite();\n       getFavouriteList()\n    //    console.log();\n   }\n   else{\n       let isExist = false;\n       console.log(getPrivateGallery());\n       for(let x of getPrivateGallery()){\n        //    console.log(\"x: \"+x.id +\"    item: \"+getCurrentItem().id);\n           if(x.id == getCurrentItem().id){\n            //    console.log(\"x!=now + \"+x.id != getCurrentItem().id);\n               isExist=true;\n            }\n       }\n       if(!isExist){\n        // console.log(\"hey\");\n         getPrivateGallery().push(getCurrentItem());\n\n         //更新数据库 个人收藏页\n         \n        addFavorite();\n        getFavouriteList()\n        }\n    }\n    // console.log(getFavouriteList());\n   let artworkList = getPrivateGallery();\n//    console.log(\"artworkList: \"+artworkList);\n    let view = new PrivateGallery_funcs.PrivateGalleryView1(artworkList = {artworkList});\n    ReactDOM.render(view, document.body.querySelector(\"#privateGallery\"));\n    \n    // view.render(document.body.querySelector(\"#privateGallery\"));\n}\nfunction addFavorite(){\n    var myHeaders = new Headers();\n    myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n\n    var urlencoded = new URLSearchParams();\n    urlencoded.append(\"email\", getUserEmail());\n    urlencoded.append(\"objectID\", getCurrentItem().id);\n    // console.log(getCurrentItem().id);\n\n    var requestOptions = {\n    method: 'POST',\n    headers: myHeaders,\n    body: urlencoded,\n    redirect: 'follow'\n    };\n\n    fetch(\"https://afternoon-gorge-52652.herokuapp.com/addFavorite\", requestOptions)\n    .then(response => response.text())\n    .then(result => console.log(result))\n    .catch(error => console.log('error', error));\n\n}\nfunction getFavouriteList(){\n    var urlencoded = new URLSearchParams();\n\nvar requestOptions = {\n  method: 'GET',\n  redirect: 'follow'\n};\nconsole.log(getUserEmail());\nfetch(\"https://afternoon-gorge-52652.herokuapp.com/getFavorite?email=\"+getUserEmail(), requestOptions)\n  .then(response => response.text())\n  .then(result => console.log(result))\n  .catch(error => console.log('error', error));\n  \n}\n\n// function keyUp(event){\n//     if(event.keyCode===38){\n            \n//     }\n// }\nfunction getArtwork(){\n\n    function handleHTTPError(response) {\n        if (response.ok)\n            return response;\n        throw Error(response.statusText);\n    }\n\n        return fetch(ENDPOINT +\"artworks?limit=30\", {\n        \"method\": \"GET\"\n    })\n    .then(handleHTTPError)\n    .then(response => response.json()) // from headers to response data\n    .then(data => data.data) // leave out the unimportant parts of the response data\n    .catch(console.error);\n}\n\nfunction getArtworkPicture(){\n\n        //通过id找到本地artworklist中的artwork -> thumbnail, width, height\n        // => image_url = thumbnail.url +/full/+ width, + /0/default.jpg\n        // https://www.artic.edu/iiif/2/7e21e656-ddae-de1c-f46b-a869224043bd/full/2101,/0/default.jpg \n\n        return \"https://www.artic.edu/iiif/2/7e21e656-ddae-de1c-f46b-a869224043bd\"+\"/full/\"+\"2101,\"+\"/0/default.jpg\";\n\n    \n}\n\n\nconst Utils_funcs = {setCurrentItem, getCurrentItem, updateDetailPage, setPrivateGallery, getPrivateGallery, updatePrivateGallery, getArtwork, \n    getArtworkPicture, getFavouriteList, initialPrivateGallery,getUserEmail,setUserEmail};\n\nexport default Utils_funcs;\n"]},"metadata":{},"sourceType":"module"}